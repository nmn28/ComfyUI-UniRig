Capturing execution frames: rig_human_with_texture.json
  Validating workflow...
  [ComfyUI] === /validate endpoint called ===
  Queuing workflow for execution...
  [ComfyUI] Received JSON with keys: ['prompt']
  [ComfyUI] Prompt has 4 nodes
  [ComfyUI]   Node 10: UniRigPreviewRiggedMesh
  [ComfyUI]     Inputs: {"fbx_output_path": ["39", 0], "preview": ""}
  [ComfyUI]   Node 27: UniRigLoadMesh
  [ComfyUI]     Inputs: {"source_folder": "input", "file_path": "3d/realistic_male_character.glb"}
  [ComfyUI]   Node 39: UniRigAutoRig
  [ComfyUI]     Inputs: {"skeleton_template": "mixamo", "fbx_name": "", "target_face_count": 50000, "trimesh": ["27", 0], "model": ["40", 0]}
  [ComfyUI]   Node 40: UniRigLoadModel
  [ComfyUI]     Inputs: {"cache_to_gpu": false}
  [ComfyUI] Generated prompt_id: 00b74afa-8c7b-47da-9555-0d4c8793c912
  [ComfyUI] Calling execution.validate_prompt()...
  [ComfyUI] Validation result: valid=True
  [ComfyUI] === Validation PASSED ===
  [ComfyUI] got prompt
  [ComfyUI]   /home/runner/work/ComfyUI-UniRig/ComfyUI-UniRig/.comfy-test-env/ComfyUI/custom_nodes/ComfyUI-UniRig/_env_unirig/lib/python3.11/site-packages/huggingface_hub/file_download.py:979: UserWarning: `local_dir_use_symlinks` parameter is deprecated and will be ignored. The process to download files to a local folder has been updated and do not rely on symlinks anymore. You only need to pass a destination folder as`local_dir`.
  [ComfyUI]   For more details, check out https://huggingface.co/docs/huggingface_hub/main/en/guides/download#download-files-to-local-folder.
  [ComfyUI]     warnings.warn(
  [ComfyUI]   01:12:52 | INFO: Data are loaded, start creating Blender stuff
  [ComfyUI]   01:12:52 | INFO: Blender create Mesh node geometry_0
  [ComfyUI]   01:12:53 | INFO: glTF import finished in 0.46s
  [ComfyUI] [UniRig] Running prestartup script...
  [ComfyUI] [UniRig] viewer_fbx.html is up to date
  [ComfyUI] [UniRig] viewer-bundle.js is up to date
  [ComfyUI] [UniRig] mesh_preview_fbx.js is up to date
  [ComfyUI] [UniRig] viewer_fbx_debug.html is up to date
  [ComfyUI] [UniRig] viewer_fbx_compare.html is up to date
  [ComfyUI] [UniRig] debug_skeleton_widget.js is up to date
  [ComfyUI] [UniRig] compare_skeleton_widget.js is up to date
  [ComfyUI] [UniRig] mixamo.fbx already exists at /home/runner/work/ComfyUI-UniRig/ComfyUI-UniRig/.comfy-test-env/ComfyUI/input/3d/mixamo.fbx
  [ComfyUI] [UniRig] realistic_male_character.glb already exists at /home/runner/work/ComfyUI-UniRig/ComfyUI-UniRig/.comfy-test-env/ComfyUI/input/3d/realistic_male_character.glb
  [ComfyUI] [UniRig] FinalBaseMesh.obj already exists at /home/runner/work/ComfyUI-UniRig/ComfyUI-UniRig/.comfy-test-env/ComfyUI/input/3d/FinalBaseMesh.obj
  [ComfyUI] [UniRig] mixamo/Dying.fbx already exists
  [ComfyUI] [UniRig] mixamo/Breakdance.fbx already exists
  [ComfyUI] [UniRig] mixamo/Hip_Hop_Dancing.fbx already exists
  [ComfyUI] [UniRig] mixamo/Mma_Kick.fbx already exists
  [ComfyUI] [UniRig] mixamo/Capoeira.fbx already exists
  [ComfyUI] [UniRig] smpl/amass_sample.npz already exists
  [ComfyUI] [UniRig] smpl/dmpl_sample.npz already exists
  [ComfyUI] [UniRig] Animation templates ready at /home/runner/work/ComfyUI-UniRig/ComfyUI-UniRig/.comfy-test-env/ComfyUI/input/animation_templates
  [ComfyUI] [UniRig] Animation character mixamo.fbx already exists
  [ComfyUI] [UniRig] Animation characters ready at /home/runner/work/ComfyUI-UniRig/ComfyUI-UniRig/.comfy-test-env/ComfyUI/input/animation_characters
  [ComfyUI] [UniRig] Prestartup script completed.
  [ComfyUI] [GeometryPack] Parsed GeomPackRemesh: 6 backends
  [ComfyUI] [GeometryPack] Parsed GeomPackFillHoles: 2 backends
  [ComfyUI] [GeometryPack] Generated backend_mappings.json
  [ComfyUI] [GeometryPack] All assets already exist in /home/runner/work/ComfyUI-UniRig/ComfyUI-UniRig/.comfy-test-env/ComfyUI/input/3d
  [ComfyUI] [ComfyUI-UniRig] Initializing custom node...
  [ComfyUI] [UniRig] Models directory: /home/runner/work/ComfyUI-UniRig/ComfyUI-UniRig/.comfy-test-env/ComfyUI/models/unirig
  [ComfyUI] [unirig] Auto-discovered v2 config: unirig
  [ComfyUI] [unirig] Auto-discovered v2 config: unirig
  [ComfyUI] [unirig] Auto-discovered v2 config: unirig
  [ComfyUI] [unirig] Auto-discovered v2 config: unirig
  [ComfyUI] [unirig] Auto-discovered v2 config: unirig
  [ComfyUI] [unirig] Auto-discovered v2 config: unirig
  [ComfyUI] [unirig] Auto-discovered v2 config: unirig
  [ComfyUI] [unirig] Auto-discovered v2 config: unirig
  [ComfyUI] [unirig] Auto-discovered v2 config: unirig
  [ComfyUI] [ComfyUI-UniRig] [OK] Node classes imported successfully
  [ComfyUI] [ComfyUI-UniRig] [OK] Loaded successfully!
  [ComfyUI] [GeomPack] CGAL Python package found - CGAL Isotropic Remesh node available
  [ComfyUI] [GeomPack] Custom server routes registered
  [ComfyUI] [UniRig FBX Files API] Returning 0 files from output directory
  [ComfyUI] [UniRig FBX Files API] Returning 0 files from output directory
  [ComfyUI] [unirig] Creating PersistentVenvWorker (python=/home/runner/work/ComfyUI-UniRig/ComfyUI-UniRig/.comfy-test-env/ComfyUI/custom_nodes/ComfyUI-UniRig/_env_unirig/bin/python)
  [ComfyUI] [unirig] → UniRigLoadModel.load_models(cache_to_gpu=bool)
  [ComfyUI] [unirig] ← UniRigLoadModel.load_models returned tuple(1 items) [16.93s]
  [ComfyUI] [UniRigLoadMesh] Found mesh in input folder: 3d/realistic_male_character.glb
  [ComfyUI] [UniRigLoadMesh] File extension detected: '.glb'
  [ComfyUI] [UniRigLoadMesh] Loading: /home/runner/work/ComfyUI-UniRig/ComfyUI-UniRig/.comfy-test-env/ComfyUI/input/3d/realistic_male_character.glb
  [ComfyUI] [UniRigLoadMesh] Loaded type: Scene
  [ComfyUI] [UniRigLoadMesh] Scene has 7 geometries
  [ComfyUI] [UniRigLoadMesh]   Geometry 'tripo_node_d0bcade7_tripo_mat_d0bcade7_0': visual type = TextureVisuals
  [ComfyUI] [UniRigLoadMesh]     Material: PBRMaterial
  [ComfyUI] [UniRigLoadMesh]     Has baseColorTexture: yes
  [ComfyUI] [UniRigLoadMesh]   Geometry 'tripo_node_d0bcade7_tripo_mat_d0bcade7_1': visual type = TextureVisuals
  [ComfyUI] [UniRigLoadMesh]     Material: PBRMaterial
  [ComfyUI] [UniRigLoadMesh]     Has baseColorTexture: yes
  [ComfyUI] [UniRigLoadMesh]   Geometry 'tripo_node_d0bcade7_tripo_mat_d0bcade7_0_2': visual type = TextureVisuals
  [ComfyUI] [UniRigLoadMesh]     Material: PBRMaterial
  [ComfyUI] [UniRigLoadMesh]     Has baseColorTexture: yes
  [ComfyUI] [UniRigLoadMesh]   Geometry 'tripo_node_d0bcade7_tripo_mat_d0bcade7_0_3': visual type = TextureVisuals
  [ComfyUI] [UniRigLoadMesh]     Material: PBRMaterial
  [ComfyUI] [UniRigLoadMesh]     Has baseColorTexture: yes
  [ComfyUI] [UniRigLoadMesh]   Geometry 'tripo_node_d0bcade7_tripo_mat_d0bcade7_0_4': visual type = TextureVisuals
  [ComfyUI] [UniRigLoadMesh]     Material: PBRMaterial
  [ComfyUI] [UniRigLoadMesh]     Has baseColorTexture: yes
  [ComfyUI] [UniRigLoadMesh]   Geometry 'tripo_node_d0bcade7_tripo_mat_d0bcade7_0_5': visual type = TextureVisuals
  [ComfyUI] [UniRigLoadMesh]     Material: PBRMaterial
  [ComfyUI] [UniRigLoadMesh]     Has baseColorTexture: yes
  [ComfyUI] [UniRigLoadMesh]   Geometry 'tripo_node_d0bcade7_tripo_mat_d0bcade7_0_6': visual type = TextureVisuals
  [ComfyUI] [UniRigLoadMesh]     Material: PBRMaterial
  [ComfyUI] [UniRigLoadMesh]     Has baseColorTexture: yes
  [ComfyUI] [UniRigLoadMesh] Converting Scene to single mesh (scene has 7 geometries)
  [ComfyUI] [UniRigLoadMesh] After dump(): visual type = TextureVisuals
  [ComfyUI] [UniRigLoadMesh] After dump(): material = PBRMaterial
  [ComfyUI] [UniRigLoadMesh] Initial mesh: 394992 vertices, 642547 faces
  [ComfyUI] [UniRigLoadMesh] Visual type: TextureVisuals
  [ComfyUI] [UniRigLoadMesh]   Has UV coords: (394992, 2)
  [ComfyUI] [UniRigLoadMesh]   Material type: PBRMaterial
  [ComfyUI] [UniRigLoadMesh]   Has baseColorTexture!
  [ComfyUI] [UniRigLoadMesh] Successfully loaded: 394992 vertices, 642547 faces
  [ComfyUI] [UniRigLoadMesh] Loaded: 394992 vertices, 642547 faces
  [ComfyUI] [unirig] → UniRigAutoRig.auto_rig(trimesh=Trimesh, model=dict, skeleton_template=str, fbx_name=str, target_face_count=int)
  [ComfyUI] [unirig] ✗ UniRigAutoRig.auto_rig failed after 30.67s: arg(): could not convert default argument 'workspace: tv::Tensor' in method '<class 'spconv.core_cc.csrc.sparse.convops.gemmops.GemmTunerSimple'>.run_with_tuned_result' into a Python object (type not registered yet?)
  [ComfyUI] 
  [ComfyUI] Worker traceback:
  [ComfyUI] Traceback (most recent call last):
  [ComfyUI]   File "/tmp/comfyui_pvenv_2c4k1dr4/persistent_worker.py", line 155, in main
  [ComfyUI]     result = method(**inputs)
  [ComfyUI]              ^^^^^^^^^^^^^^^^
  [ComfyUI]   File "/home/runner/work/ComfyUI-UniRig/ComfyUI-UniRig/nodes/auto_rig.py", line 92, in auto_rig
  [ComfyUI]     normalized_mesh, skeleton, texture_preview = skeleton_extractor.extract(
  [ComfyUI]                                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  [ComfyUI]   File "/home/runner/work/ComfyUI-UniRig/ComfyUI-UniRig/nodes/skeleton_extraction.py", line 415, in extract
  [ComfyUI]     direct_skeleton_result, norm_params = direct_module.predict_skeleton_from_mesh(
  [ComfyUI]                                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  [ComfyUI]   File "/home/runner/work/ComfyUI-UniRig/ComfyUI-UniRig/.comfy-test-env/ComfyUI/custom_nodes/ComfyUI-UniRig/_env_unirig/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
  [ComfyUI]     return func(*args, **kwargs)
  [ComfyUI]            ^^^^^^^^^^^^^^^^^^^^^
  [ComfyUI]   File "/home/runner/work/ComfyUI-UniRig/ComfyUI-UniRig/nodes/lib/unirig/src/inference/direct.py", line 515, in predict_skeleton_from_mesh
  [ComfyUI]     skeleton = predict_skeleton(
  [ComfyUI]                ^^^^^^^^^^^^^^^^^
  [ComfyUI]   File "/home/runner/work/ComfyUI-UniRig/ComfyUI-UniRig/.comfy-test-env/ComfyUI/custom_nodes/ComfyUI-UniRig/_env_unirig/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
  [ComfyUI]     return func(*args, **kwargs)
  [ComfyUI]            ^^^^^^^^^^^^^^^^^^^^^
  [ComfyUI]   File "/home/runner/work/ComfyUI-UniRig/ComfyUI-UniRig/nodes/lib/unirig/src/inference/direct.py", line 321, in predict_skeleton
  [ComfyUI]     model, tokenizer = get_skeleton_model(checkpoint_path, device)
  [ComfyUI]                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  [ComfyUI]   File "/home/runner/work/ComfyUI-UniRig/ComfyUI-UniRig/nodes/lib/unirig/src/inference/direct.py", line 273, in get_skeleton_model
  [ComfyUI]     _MODEL_CACHE[cache_key] = _load_skeleton_model(checkpoint_path, device)
  [ComfyUI]                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  [ComfyUI]   File "/home/runner/work/ComfyUI-UniRig/ComfyUI-UniRig/nodes/lib/unirig/src/inference/direct.py", line 165, in _load_skeleton_model
  [ComfyUI]     from src.model.parse import get_model
  [ComfyUI]   File "/home/runner/work/ComfyUI-UniRig/ComfyUI-UniRig/nodes/lib/unirig/src/model/parse.py", line 1, in <module>
  [ComfyUI]     from .unirig_ar import UniRigAR
  [ComfyUI]   File "/home/runner/work/ComfyUI-UniRig/ComfyUI-UniRig/nodes/lib/unirig/src/model/unirig_ar.py", line 16, in <module>
  [ComfyUI]     from .parse_encoder import MAP_MESH_ENCODER, get_mesh_encoder
  [ComfyUI]   File "/home/runner/work/ComfyUI-UniRig/ComfyUI-UniRig/nodes/lib/unirig/src/model/parse_encoder.py", line 7, in <module>
  [ComfyUI] !!! Exception during processing !!! arg(): could not convert default argument 'workspace: tv::Tensor' in method '<class 'spconv.core_cc.csrc.sparse.convops.gemmops.GemmTunerSimple'>.run_with_tuned_result' into a Python object (type not registered yet?)
  [ComfyUI] 
  [ComfyUI] Worker traceback:
  [ComfyUI] Traceback (most recent call last):
  [ComfyUI]   File "/tmp/comfyui_pvenv_2c4k1dr4/persistent_worker.py", line 155, in main
  [ComfyUI]     result = method(**inputs)
  [ComfyUI]              ^^^^^^^^^^^^^^^^
  [ComfyUI]   File "/home/runner/work/ComfyUI-UniRig/ComfyUI-UniRig/nodes/auto_rig.py", line 92, in auto_rig
  [ComfyUI]     normalized_mesh, skeleton, texture_preview = skeleton_extractor.extract(
  [ComfyUI]                                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  [ComfyUI]   File "/home/runner/work/ComfyUI-UniRig/ComfyUI-UniRig/nodes/skeleton_extraction.py", line 415, in extract
  [ComfyUI]     direct_skeleton_result, norm_params = direct_module.predict_skeleton_from_mesh(
  [ComfyUI]                                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  [ComfyUI]   File "/home/runner/work/ComfyUI-UniRig/ComfyUI-UniRig/.comfy-test-env/ComfyUI/custom_nodes/ComfyUI-UniRig/_env_unirig/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
  [ComfyUI]     return func(*args, **kwargs)
  [ComfyUI]            ^^^^^^^^^^^^^^^^^^^^^
  [ComfyUI]   File "/home/runner/work/ComfyUI-UniRig/ComfyUI-UniRig/nodes/lib/unirig/src/inference/direct.py", line 515, in predict_skeleton_from_mesh
  [ComfyUI]     skeleton = predict_skeleton(
  [ComfyUI]                ^^^^^^^^^^^^^^^^^
  [ComfyUI]   File "/home/runner/work/ComfyUI-UniRig/ComfyUI-UniRig/.comfy-test-env/ComfyUI/custom_nodes/ComfyUI-UniRig/_env_unirig/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
  [ComfyUI]     return func(*args, **kwargs)
  [ComfyUI]            ^^^^^^^^^^^^^^^^^^^^^
  [ComfyUI]   File "/home/runner/work/ComfyUI-UniRig/ComfyUI-UniRig/nodes/lib/unirig/src/inference/direct.py", line 321, in predict_skeleton
  [ComfyUI]     model, tokenizer = get_skeleton_model(checkpoint_path, device)
  [ComfyUI]                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  [ComfyUI]   File "/home/runner/work/ComfyUI-UniRig/ComfyUI-UniRig/nodes/lib/unirig/src/inference/direct.py", line 273, in get_skeleton_model
  [ComfyUI]     _MODEL_CACHE[cache_key] = _load_skeleton_model(checkpoint_path, device)
  [ComfyUI]                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  [ComfyUI]   File "/home/runner/work/ComfyUI-UniRig/ComfyUI-UniRig/nodes/lib/unirig/src/inference/direct.py", line 165, in _load_skeleton_model
  [ComfyUI]     from src.model.parse import get_model
  [ComfyUI]   File "/home/runner/work/ComfyUI-UniRig/ComfyUI-UniRig/nodes/lib/unirig/src/model/parse.py", line 1, in <module>
  [ComfyUI]     from .unirig_ar import UniRigAR
  [ComfyUI]   File "/home/runner/work/ComfyUI-UniRig/ComfyUI-UniRig/nodes/lib/unirig/src/model/unirig_ar.py", line 16, in <module>
  [ComfyUI]     from .parse_encoder import MAP_MESH_ENCODER, get_mesh_encoder
  [ComfyUI]   File "/home/runner/work/ComfyUI-UniRig/ComfyUI-UniRig/nodes/lib/unirig/src/model/parse_encoder.py", line 7, in <module>
  [ComfyUI]     from .pointcept.models.PTv3Object import get_encoder as get_encoder_ptv3obj
  [ComfyUI]   File "/home/runner/work/ComfyUI-UniRig/ComfyUI-UniRig/nodes/lib/unirig/src/model/pointcept/models/__init__.py", line 1, in <module>
  [ComfyUI]     from .PTv3Object import PointTransformerV3Object
  [ComfyUI]   File "/home/runner/work/ComfyUI-UniRig/ComfyUI-UniRig/nodes/lib/unirig/src/model/pointcept/models/PTv3Object.py", line 6, in <module>
  [ComfyUI]     import spconv.pytorch as spconv
  [ComfyUI]   File "/home/runner/work/ComfyUI-UniRig/ComfyUI-UniRig/.comfy-test-env/ComfyUI/custom_nodes/ComfyUI-UniRig/_env_unirig/lib/python3.11/site-packages/spconv/pytorch/__init__.py", line 7, in <module>
  [ComfyUI]     from spconv.pytorch.core import SparseConvTensor
  [ComfyUI]   File "/home/runner/work/ComfyUI-UniRig/ComfyUI-UniRig/.comfy-test-env/ComfyUI/custom_nodes/ComfyUI-UniRig/_env_unirig/lib/python3.11/site-packages/spconv/pytorch/core.py", line 21, in <module>
  [ComfyUI]     from spconv.tools import CUDAKernelTimer
  [ComfyUI]   File "/home/runner/work/ComfyUI-UniRig/ComfyUI-UniRig/.comfy-test-env/ComfyUI/custom_nodes/ComfyUI-UniRig/_env_unirig/lib/python3.11/site-packages/spconv/tools.py", line 16, in <module>
  [ComfyUI]     from spconv.cppconstants import CPU_ONLY_BUILD
  [ComfyUI]   File "/home/runner/work/ComfyUI-UniRig/ComfyUI-UniRig/.comfy-test-env/ComfyUI/custom_nodes/ComfyUI-UniRig/_env_unirig/lib/python3.11/site-packages/spconv/cppconstants.py", line 15, in <module>
  [ComfyUI]     import spconv.core_cc as _ext
  [ComfyUI] ImportError: arg(): could not convert default argument 'workspace: tv::Tensor' in method '<class 'spconv.core_cc.csrc.sparse.convops.gemmops.GemmTunerSimple'>.run_with_tuned_result' into a Python object (type not registered yet?)
  [ComfyUI] 
  [ComfyUI] Traceback (most recent call last):
  [ComfyUI]   File "/home/runner/work/ComfyUI-UniRig/ComfyUI-UniRig/.comfy-test-env/ComfyUI/execution.py", line 518, in execute
  [ComfyUI]     output_data, output_ui, has_subgraph, has_pending_tasks = await get_output_data(prompt_id, unique_id, obj, input_data_all, execution_block_cb=execution_block_cb, pre_execute_cb=pre_execute_cb, v3_data=v3_data)
  [ComfyUI]                                                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  [ComfyUI]   File "/home/runner/work/ComfyUI-UniRig/ComfyUI-UniRig/.comfy-test-env/ComfyUI/execution.py", line 329, in get_output_data
  [ComfyUI]     return_values = await _async_map_node_over_list(prompt_id, unique_id, obj, input_data_all, obj.FUNCTION, allow_interrupt=True, execution_block_cb=execution_block_cb, pre_execute_cb=pre_execute_cb, v3_data=v3_data)
  [ComfyUI]                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  [ComfyUI]   File "/home/runner/work/ComfyUI-UniRig/ComfyUI-UniRig/.comfy-test-env/ComfyUI/execution.py", line 303, in _async_map_node_over_list
  [ComfyUI]     await process_inputs(input_dict, i)
  [ComfyUI]   File "/home/runner/work/ComfyUI-UniRig/ComfyUI-UniRig/.comfy-test-env/ComfyUI/execution.py", line 291, in process_inputs
  [ComfyUI]     result = f(**inputs)
  [ComfyUI]              ^^^^^^^^^^^
  [ComfyUI]   File "/opt/hostedtoolcache/Python/3.12.12/x64/lib/python3.12/site-packages/comfy_env/decorator.py", line 412, in proxy
  [ComfyUI]     result = worker.call_method(
  [ComfyUI]              ^^^^^^^^^^^^^^^^^^^
  [ComfyUI]   File "/opt/hostedtoolcache/Python/3.12.12/x64/lib/python3.12/site-packages/comfy_env/workers/venv.py", line 1014, in call_method
  [ComfyUI]     raise WorkerError(
  [ComfyUI] comfy_env.workers.base.WorkerError: arg(): could not convert default argument 'workspace: tv::Tensor' in method '<class 'spconv.core_cc.csrc.sparse.convops.gemmops.GemmTunerSimple'>.run_with_tuned_result' into a Python object (type not registered yet?)
  [ComfyUI] 
  [ComfyUI] Worker traceback:
  [ComfyUI] Traceback (most recent call last):
  [ComfyUI]   File "/tmp/comfyui_pvenv_2c4k1dr4/persistent_worker.py", line 155, in main
  [ComfyUI]     result = method(**inputs)
  [ComfyUI]              ^^^^^^^^^^^^^^^^
  [ComfyUI]   File "/home/runner/work/ComfyUI-UniRig/ComfyUI-UniRig/nodes/auto_rig.py", line 92, in auto_rig
  [ComfyUI]     normalized_mesh, skeleton, texture_preview = skeleton_extractor.extract(
  [ComfyUI]                                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  [ComfyUI]   File "/home/runner/work/ComfyUI-UniRig/ComfyUI-UniRig/nodes/skeleton_extraction.py", line 415, in extract
  [ComfyUI]     direct_skeleton_result, norm_params = direct_module.predict_skeleton_from_mesh(
  [ComfyUI]                                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  [ComfyUI]   File "/home/runner/work/ComfyUI-UniRig/ComfyUI-UniRig/.comfy-test-env/ComfyUI/custom_nodes/ComfyUI-UniRig/_env_unirig/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
  [ComfyUI]     return func(*args, **kwargs)
  [ComfyUI]            ^^^^^^^^^^^^^^^^^^^^^
  [ComfyUI]   File "/home/runner/work/ComfyUI-UniRig/ComfyUI-UniRig/nodes/lib/unirig/src/inference/direct.py", line 515, in predict_skeleton_from_mesh
  [ComfyUI]     skeleton = predict_skeleton(
  [ComfyUI]                ^^^^^^^^^^^^^^^^^
  [ComfyUI]   File "/home/runner/work/ComfyUI-UniRig/ComfyUI-UniRig/.comfy-test-env/ComfyUI/custom_nodes/ComfyUI-UniRig/_env_unirig/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
  [ComfyUI]     return func(*args, **kwargs)
  [ComfyUI]            ^^^^^^^^^^^^^^^^^^^^^
  [ComfyUI]   File "/home/runner/work/ComfyUI-UniRig/ComfyUI-UniRig/nodes/lib/unirig/src/inference/direct.py", line 321, in predict_skeleton
  [ComfyUI]     model, tokenizer = get_skeleton_model(checkpoint_path, device)
  [ComfyUI]                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  [ComfyUI]   File "/home/runner/work/ComfyUI-UniRig/ComfyUI-UniRig/nodes/lib/unirig/src/inference/direct.py", line 273, in get_skeleton_model
  [ComfyUI]     _MODEL_CACHE[cache_key] = _load_skeleton_model(checkpoint_path, device)
  [ComfyUI]                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  [ComfyUI]   File "/home/runner/work/ComfyUI-UniRig/ComfyUI-UniRig/nodes/lib/unirig/src/inference/direct.py", line 165, in _load_skeleton_model
  [ComfyUI]     from src.model.parse import get_model
  [ComfyUI]   File "/home/runner/work/ComfyUI-UniRig/ComfyUI-UniRig/nodes/lib/unirig/src/model/parse.py", line 1, in <module>
  [ComfyUI]     from .unirig_ar import UniRigAR
  [ComfyUI]   File "/home/runner/work/ComfyUI-UniRig/ComfyUI-UniRig/nodes/lib/unirig/src/model/unirig_ar.py", line 16, in <module>
  [ComfyUI]     from .parse_encoder import MAP_MESH_ENCODER, get_mesh_encoder
  [ComfyUI]   File "/home/runner/work/ComfyUI-UniRig/ComfyUI-UniRig/nodes/lib/unirig/src/model/parse_encoder.py", line 7, in <module>
  [ComfyUI]     from .pointcept.models.PTv3Object import get_encoder as get_encoder_ptv3obj
  [ComfyUI]   File "/home/runner/work/ComfyUI-UniRig/ComfyUI-UniRig/nodes/lib/unirig/src/model/pointcept/models/__init__.py", line 1, in <module>
  [ComfyUI]     from .PTv3Object import PointTransformerV3Object
  [ComfyUI]   File "/home/runner/work/ComfyUI-UniRig/ComfyUI-UniRig/nodes/lib/unirig/src/model/pointcept/models/PTv3Object.py", line 6, in <module>
  [ComfyUI]     import spconv.pytorch as spconv
  [ComfyUI]   File "/home/runner/work/ComfyUI-UniRig/ComfyUI-UniRig/.comfy-test-env/ComfyUI/custom_nodes/ComfyUI-UniRig/_env_unirig/lib/python3.11/site-packages/spconv/pytorch/__init__.py", line 7, in <module>
  [ComfyUI]     from spconv.pytorch.core import SparseConvTensor
  [ComfyUI]   File "/home/runner/work/ComfyUI-UniRig/ComfyUI-UniRig/.comfy-test-env/ComfyUI/custom_nodes/ComfyUI-UniRig/_env_unirig/lib/python3.11/site-packages/spconv/pytorch/core.py", line 21, in <module>
  [ComfyUI]     from spconv.tools import CUDAKernelTimer
  [ComfyUI]   File "/home/runner/work/ComfyUI-UniRig/ComfyUI-UniRig/.comfy-test-env/ComfyUI/custom_nodes/ComfyUI-UniRig/_env_unirig/lib/python3.11/site-packages/spconv/tools.py", line 16, in <module>
  [ComfyUI]     from spconv.cppconstants import CPU_ONLY_BUILD
  [ComfyUI]   File "/home/runner/work/ComfyUI-UniRig/ComfyUI-UniRig/.comfy-test-env/ComfyUI/custom_nodes/ComfyUI-UniRig/_env_unirig/lib/python3.11/site-packages/spconv/cppconstants.py", line 15, in <module>
  [ComfyUI]     import spconv.core_cc as _ext
  [ComfyUI] ImportError: arg(): could not convert default argument 'workspace: tv::Tensor' in method '<class 'spconv.core_cc.csrc.sparse.convops.gemmops.GemmTunerSimple'>.run_with_tuned_result' into a Python object (type not registered yet?)
  [ComfyUI] 
  [ComfyUI] 
  [ComfyUI] Prompt executed in 48.93 seconds
  Execution error: {'prompt_id': '8941b084-c248-4210-9f28-43fcc07831be', 'node_id': '39', 'node_type': 'UniRigAutoRig', 'executed': ['40', '27'], 'exception_message': 'arg(): could not convert default argument \'workspace: tv::Tensor\' in method \'<class \'spconv.core_cc.csrc.sparse.convops.gemmops.GemmTunerSimple\'>.run_with_tuned_result\' into a Python object (type not registered yet?)\n\nWorker traceback:\nTraceback (most recent call last):\n  File "/tmp/comfyui_pvenv_2c4k1dr4/persistent_worker.py", line 155, in main\n    result = method(**inputs)\n             ^^^^^^^^^^^^^^^^\n  File "/home/runner/work/ComfyUI-UniRig/ComfyUI-UniRig/nodes/auto_rig.py", line 92, in auto_rig\n    normalized_mesh, skeleton, texture_preview = skeleton_extractor.extract(\n                                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/runner/work/ComfyUI-UniRig/ComfyUI-UniRig/nodes/skeleton_extraction.py", line 415, in extract\n    direct_skeleton_result, norm_params = direct_module.predict_skeleton_from_mesh(\n                                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/runner/work/ComfyUI-UniRig/ComfyUI-UniRig/.comfy-test-env/ComfyUI/custom_nodes/ComfyUI-UniRig/_env_unirig/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context\n    return func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^\n  File "/home/runner/work/ComfyUI-UniRig/ComfyUI-UniRig/nodes/lib/unirig/src/inference/direct.py", line 515, in predict_skeleton_from_mesh\n    skeleton = predict_skeleton(\n               ^^^^^^^^^^^^^^^^^\n  File "/home/runner/work/ComfyUI-UniRig/ComfyUI-UniRig/.comfy-test-env/ComfyUI/custom_nodes/ComfyUI-UniRig/_env_unirig/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context\n    return func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^\n  File "/home/runner/work/ComfyUI-UniRig/ComfyUI-UniRig/nodes/lib/unirig/src/inference/direct.py", line 321, in predict_skeleton\n    model, tokenizer = get_skeleton_model(checkpoint_path, device)\n                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/runner/work/ComfyUI-UniRig/ComfyUI-UniRig/nodes/lib/unirig/src/inference/direct.py", line 273, in get_skeleton_model\n    _MODEL_CACHE[cache_key] = _load_skeleton_model(checkpoint_path, device)\n                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/runner/work/ComfyUI-UniRig/ComfyUI-UniRig/nodes/lib/unirig/src/inference/direct.py", line 165, in _load_skeleton_model\n    from src.model.parse import get_model\n  File "/home/runner/work/ComfyUI-UniRig/ComfyUI-UniRig/nodes/lib/unirig/src/model/parse.py", line 1, in <module>\n    from .unirig_ar import UniRigAR\n  File "/home/runner/work/ComfyUI-UniRig/ComfyUI-UniRig/nodes/lib/unirig/src/model/unirig_ar.py", line 16, in <module>\n    from .parse_encoder import MAP_MESH_ENCODER, get_mesh_encoder\n  File "/home/runner/work/ComfyUI-UniRig/ComfyUI-UniRig/nodes/lib/unirig/src/model/parse_encoder.py", line 7, in <module>\n    from .pointcept.models.PTv3Object import get_encoder as get_encoder_ptv3obj\n  File "/home/runner/work/ComfyUI-UniRig/ComfyUI-UniRig/nodes/lib/unirig/src/model/pointcept/models/__init__.py", line 1, in <module>\n    from .PTv3Object import PointTransformerV3Object\n  File "/home/runner/work/ComfyUI-UniRig/ComfyUI-UniRig/nodes/lib/unirig/src/model/pointcept/models/PTv3Object.py", line 6, in <module>\n    import spconv.pytorch as spconv\n  File "/home/runner/work/ComfyUI-UniRig/ComfyUI-UniRig/.comfy-test-env/ComfyUI/custom_nodes/ComfyUI-UniRig/_env_unirig/lib/python3.11/site-packages/spconv/pytorch/__init__.py", line 7, in <module>\n    from spconv.pytorch.core import SparseConvTensor\n  File "/home/runner/work/ComfyUI-UniRig/ComfyUI-UniRig/.comfy-test-env/ComfyUI/custom_nodes/ComfyUI-UniRig/_env_unirig/lib/python3.11/site-packages/spconv/pytorch/core.py", line 21, in <module>\n    from spconv.tools import CUDAKernelTimer\n  File "/home/runner/work/ComfyUI-UniRig/ComfyUI-UniRig/.comfy-test-env/ComfyUI/custom_nodes/ComfyUI-UniRig/_env_unirig/lib/python3.11/site-packages/spconv/tools.py", line 16, in <module>\n    from spconv.cppconstants import CPU_ONLY_BUILD\n  File "/home/runner/work/ComfyUI-UniRig/ComfyUI-UniRig/.comfy-test-env/ComfyUI/custom_nodes/ComfyUI-UniRig/_env_unirig/lib/python3.11/site-packages/spconv/cppconstants.py", line 15, in <module>\n    import spconv.core_cc as _ext\nImportError: arg(): could not convert default argument \'workspace: tv::Tensor\' in method \'<class \'spconv.core_cc.csrc.sparse.convops.gemmops.GemmTunerSimple\'>.run_with_tuned_result\' into a Python object (type not registered yet?)\n\n', 'exception_type': 'comfy_env.workers.base.WorkerError', 'traceback': ['  File "/home/runner/work/ComfyUI-UniRig/ComfyUI-UniRig/.comfy-test-env/ComfyUI/execution.py", line 518, in execute\n    output_data, output_ui, has_subgraph, has_pending_tasks = await get_output_data(prompt_id, unique_id, obj, input_data_all, execution_block_cb=execution_block_cb, pre_execute_cb=pre_execute_cb, v3_data=v3_data)\n                                                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n', '  File "/home/runner/work/ComfyUI-UniRig/ComfyUI-UniRig/.comfy-test-env/ComfyUI/execution.py", line 329, in get_output_data\n    return_values = await _async_map_node_over_list(prompt_id, unique_id, obj, input_data_all, obj.FUNCTION, allow_interrupt=True, execution_block_cb=execution_block_cb, pre_execute_cb=pre_execute_cb, v3_data=v3_data)\n                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n', '  File "/home/runner/work/ComfyUI-UniRig/ComfyUI-UniRig/.comfy-test-env/ComfyUI/execution.py", line 303, in _async_map_node_over_list\n    await process_inputs(input_dict, i)\n', '  File "/home/runner/work/ComfyUI-UniRig/ComfyUI-UniRig/.comfy-test-env/ComfyUI/execution.py", line 291, in process_inputs\n    result = f(**inputs)\n             ^^^^^^^^^^^\n', '  File "/opt/hostedtoolcache/Python/3.12.12/x64/lib/python3.12/site-packages/comfy_env/decorator.py", line 412, in proxy\n    result = worker.call_method(\n             ^^^^^^^^^^^^^^^^^^^\n', '  File "/opt/hostedtoolcache/Python/3.12.12/x64/lib/python3.12/site-packages/comfy_env/workers/venv.py", line 1014, in call_method\n    raise WorkerError(\n'], 'current_inputs': {'skeleton_template': ['mixamo'], 'fbx_name': [''], 'target_face_count': [50000], 'trimesh': ['<trimesh.Trimesh(vertices.shape=(394992, 3), faces.shape=(642547, 3), name=`realistic_male_character.glb`)>'], 'model': ["{'skeleton_model': {'type': 'skeleton', 'model_id': 'apozz/UniRig-safetensors', 'task_config_path': '/home/runner/work/ComfyUI-UniRig/ComfyUI-UniRig/nodes/lib/unirig/configs/task/quick_inference_skeleton_articulationxl_ar_256.yaml', 'checkpoint_path': '/home/runner/work/ComfyUI-UniRig/ComfyUI-UniRig/.comfy-test-env/ComfyUI/custom_nodes/ComfyUI-UniRig/.comfy-test-env/ComfyUI/models/unirig/skeleton.safetensors', 'model_config': {'__target__': 'unirig_ar', 'llm': {'pretrained_model_name_or_path': 'facebook/opt-350m', 'n_positions': 3076, 'max_position_embeddings': 3076, 'hidden_size': 1024, 'num_attention_heads': 16, 'num_hidden_layers': 24, 'ffn_dim': 4096, 'word_embed_proj_dim': 1024, 'do_layer_norm_before': True, '_attn_implementation': 'flash_attention_2'}, 'mesh_encoder': {'__target__': 'michelangelo_encoder', 'pretrained_path': None, 'freeze_encoder': False, 'device': 'cpu', 'dtype': 'float32', 'num_latents': 512, 'embed_dim': 64, 'point_feats': 3, 'num_freqs': 8, 'include_pi': False, 'heads': 8, 'width': 512, 'num_encoder_layers': 16, 'use_ln_post': True, 'init_scale': 0.25, 'qkv_bias': False, 'use_checkpoint': False, 'flash': True, 'supervision_type': 'sdf', 'query_method': False, 'token_num': 1024}}, 'tokenizer_config': {'method': 'tokenizer_part', 'num_discrete': 256, 'continuous_range': [-1, 1], 'cls_token_id': {'vroid': 0, 'mixamo': 1, 'articulationxl': 2}, 'parts_token_id': {'body': 0, 'hand': 1}, 'order_config': {'skeleton_path': {'vroid': './configs/skeleton/vroid.yaml', 'mixamo': './configs/skeleton/mixamo.yaml'}}}, 'unirig_path': '/home/runner/work/ComfyUI-UniRig/ComfyUI-UniRig/nodes/lib/unirig', 'models_dir': '/home/runner/work/ComfyUI-UniRig/ComfyUI-UniRig/.comfy-test-env/ComfyUI/custom_nodes/ComfyUI-UniRig/.comfy-test-env/ComfyUI/models/unirig', 'cached': True, 'cache_to_gpu': False, 'model_cache_key': None}, 'skinning_model': {'type': 'skinning', 'model_id': 'apozz/UniRig-safetensors', 'task_config_path': '/home/runner/work/ComfyUI-UniRig/ComfyUI-UniRig/nodes/lib/unirig/configs/task/quick_inference_unirig_skin.yaml', 'checkpoint_path': '/home/runner/work/ComfyUI-UniRig/ComfyUI-UniRig/.comfy-test-env/ComfyUI/custom_nodes/ComfyUI-UniRig/.comfy-test-env/ComfyUI/models/unirig/skin.safetensors', 'model_config': {'__target__': 'unirig_skin', 'num_train_vertex': 512, 'num_heads': 16, 'feat_dim': 768, 'grid_size': 0.005, 'mlp_dim': 512, 'num_bone_attn': 8, 'num_mesh_bone_attn': 16, 'bone_embed_dim': 1024, 'voxel_mask': 3.0, 'mesh_encoder': {'__target__': 'ptv3obj', 'pretrained_path': None, 'freeze_encoder': False, 'in_channels': 9, 'cls_mode': False, 'shuffle_orders': True, 'drop_path': 0.0, 'upcast_attention': False, 'upcast_softmax': False, 'enc_depths': [3, 3, 3, 6, 16], 'enc_channels': [32, 64, 128, 256, 384], 'enc_num_head': [2, 4, 8, 16, 24], 'enable_qknorm': True, 'layer_norm': False, 'res_linear': True}, 'global_encoder': {'__target__': 'michelangelo_encoder', 'pretrained_path': None, 'freeze_encoder': False, 'device': 'cpu', 'dtype': 'float32', 'num_latents': 512, 'embed_dim': 64, 'point_feats': 3, 'num_freqs': 8, 'include_pi': False, 'heads': 8, 'width': 512, 'num_encoder_layers': 16, 'use_ln_post': True, 'init_scale': 0.25, 'qkv_bias': False, 'use_checkpoint': False, 'flash': True, 'supervision_type': 'sdf', 'query_method': False, 'token_num': 1024}}, 'unirig_path': '/home/runner/work/ComfyUI-UniRig/ComfyUI-UniRig/nodes/lib/unirig', 'models_dir': '/home/runner/work/ComfyUI-UniRig/ComfyUI-UniRig/.comfy-test-env/ComfyUI/custom_nodes/ComfyUI-UniRig/.comfy-test-env/ComfyUI/models/unirig', 'cached': True, 'cache_to_gpu': False, 'model_cache_key': None}, 'model_id': 'apozz/UniRig-safetensors', 'cache_to_gpu': False}"]}, 'current_outputs': ['40', '39', '10', '27'], 'timestamp': 1769303598876}
  Captured 164 frames over 51.14s
  7 unique frames saved as WebP
  Waiting 5000ms for previews to render...
  Saved high-quality screenshot: rig_human_with_texture_executed.png
    Captured 8 video frames